import{_ as q,c as i,h as y,a as e,b as m,r as h,n as p,g,e as u,v as b,k as v,d as w,F as _,j as U,i as k,t as l,w as A,u as C,q as F,o as a}from"./index-urv8ZhUX.js";import{N as M}from"./NavBar-DUvPfABS.js";function L(s,t="short"){if(!s)return"-";try{const d=new Date(s);if(isNaN(d.getTime()))return"-";const x={short:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},time:{hour:"2-digit",minute:"2-digit"},datetime:{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}};return d.toLocaleString("en-US",x[t]||x.short)}catch(d){return console.error("Date formatting error:",d),"-"}}function N(s){if(!s)return"-";try{const t=new Date(s);return isNaN(t.getTime())?"-":t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}catch{return"-"}}const c=F.create({baseURL:"https://speedlab-agile-a0ayh9gvbaaxdddt.eastus2-01.azurewebsites.net/api",headers:{"Content-Type":"application/json",Accept:"application/json"}});c.interceptors.request.use(s=>{const t=localStorage.getItem("token");return t&&(s.headers.Authorization=`Bearer ${t}`),s});const V={name:"Admin",components:{NavBar:M},data(){return{activeTab:"users",loading:!1,saving:!1,users:[],auditLogs:[],showCreateUserModal:!1,editingUser:null,userSearch:"",userRoleFilter:"",userForm:{name:"",email:"",password:"",password_confirmation:"",role:"member",timezone:"America/New_York"},formError:null}},computed:{user(){return C().user},filteredUsers(){let s=this.users;if(this.userSearch){const t=this.userSearch.toLowerCase();s=s.filter(d=>d.name.toLowerCase().includes(t)||d.email.toLowerCase().includes(t))}return this.userRoleFilter&&(s=s.filter(t=>t.role===this.userRoleFilter)),s}},async mounted(){if(this.user?.role!=="admin"){this.$router.push("/dashboard");return}await this.loadUsers(),await this.loadAuditLogs()},methods:{async loadUsers(){this.loading=!0;try{const s=await c.get("/users");this.users=s.data.data||s.data||[]}catch(s){console.error("Error loading users:",s)}finally{this.loading=!1}},async loadAuditLogs(){try{const s=await c.get("/audit-logs?limit=20");this.auditLogs=s.data.data||s.data||[]}catch(s){console.error("Error loading audit logs:",s)}},async saveUser(){this.formError=null,this.saving=!0;try{this.editingUser?(await c.put(`/users/${this.editingUser.id}`,this.userForm)).data.success&&(await this.loadUsers(),this.closeUserModal()):(await c.post("/users",this.userForm)).data.success&&(await this.loadUsers(),this.closeUserModal())}catch(s){this.formError=s.response?.data?.message||"Failed to save user"}finally{this.saving=!1}},editUser(s){this.editingUser=s,this.userForm={name:s.name,email:s.email,role:s.role,timezone:s.timezone||"America/New_York"}},async toggleUserStatus(s){if(confirm(`Are you sure you want to ${s.is_active?"deactivate":"activate"} this user?`))try{await c.patch(`/users/${s.id}/status`,{is_active:!s.is_active}),await this.loadUsers()}catch{alert("Failed to update user status")}},closeUserModal(){this.showCreateUserModal=!1,this.editingUser=null,this.userForm={name:"",email:"",password:"",password_confirmation:"",role:"member",timezone:"America/New_York"},this.formError=null},getInitials(s){return s?.split(" ").map(t=>t[0]).join("").toUpperCase()||"??"},getRoleLabel(s){return{admin:"Admin",squad_lead:"Squad Lead",member:"Member",viewer:"Viewer"}[s]||s},getRoleBadgeClass(s){return{admin:"bg-red-100 text-red-800",squad_lead:"bg-purple-100 text-purple-800",member:"bg-blue-100 text-blue-800",viewer:"bg-gray-100 text-gray-800"}[s]||"bg-gray-100 text-gray-800"},formatDate:L,formatTime:N,handleLogout(){C().logout(),this.$router.push("/login")}}},z={class:"min-h-screen bg-gray-50"},E={class:"px-4 py-8 mx-auto max-w-7xl sm:px-6 lg:px-8"},R={class:"mb-6"},j={class:"border-b border-gray-200"},B={class:"flex -mb-px space-x-8"},D={key:0,class:"space-y-6"},P={class:"p-6 bg-white border border-gray-200 shadow-sm rounded-xl"},I={class:"flex items-center justify-between"},Y={class:"flex gap-4 mt-4"},H={class:"flex-1"},J={class:"overflow-hidden bg-white border border-gray-200 shadow-sm rounded-xl"},O={key:0,class:"p-8 text-center"},G={key:1,class:"p-8 text-center text-gray-500"},K={key:2,class:"min-w-full divide-y divide-gray-200"},Q={class:"bg-white divide-y divide-gray-200"},W={class:"px-6 py-4 whitespace-nowrap"},X={class:"flex items-center"},Z={class:"flex items-center justify-center w-10 h-10 bg-blue-100 rounded-full"},$={class:"text-sm font-medium text-blue-600"},ee={class:"ml-4"},te={class:"text-sm font-medium text-gray-900"},se={class:"px-6 py-4 text-sm text-gray-900 whitespace-nowrap"},re={class:"px-6 py-4 whitespace-nowrap"},oe={class:"px-6 py-4 text-sm text-gray-500 whitespace-nowrap"},ie={class:"px-6 py-4 whitespace-nowrap"},ae={class:"px-6 py-4 space-x-2 text-sm font-medium whitespace-nowrap"},le=["onClick"],ne=["onClick"],de={key:1},ue={class:"p-6 bg-white border border-gray-200 shadow-sm rounded-xl"},me={class:"text-gray-600"},pe={key:2},ce={class:"p-6 bg-white border border-gray-200 shadow-sm rounded-xl"},ge={class:"text-gray-600"},be={key:3},xe={class:"p-6 bg-white border border-gray-200 shadow-sm rounded-xl"},ye={class:"space-y-3"},ve={class:"flex-1"},fe={class:"text-sm text-gray-900"},he={class:"mt-1 text-xs text-gray-500"},we={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50"},_e={class:"bg-white rounded-xl max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto"},Ue={class:"mb-6 text-xl font-bold text-gray-900"},ke={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Ce=["disabled"],Se={key:0,class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Te=["required"],qe=["required"],Ae={key:1,class:"p-4 text-red-700 border-l-4 border-red-500 rounded bg-red-50"},Fe={class:"text-sm"},Me={class:"flex gap-3 pt-4"},Le=["disabled"];function Ne(s,t,d,x,r,n){const S=h("NavBar"),f=h("router-link");return a(),i("div",z,[y(S),e("div",E,[t[27]||(t[27]=e("div",{class:"mb-8"},[e("h2",{class:"text-3xl font-bold text-gray-900"},"Admin Panel"),e("p",{class:"mt-1 text-gray-600"},"Manage users, squads, and system configuration")],-1)),e("div",R,[e("div",j,[e("nav",B,[e("button",{onClick:t[0]||(t[0]=o=>r.activeTab="users"),class:p(["py-4 px-1 border-b-2 font-medium text-sm",r.activeTab==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])}," User Management ",2),e("button",{onClick:t[1]||(t[1]=o=>r.activeTab="squads"),class:p(["py-4 px-1 border-b-2 font-medium text-sm",r.activeTab==="squads"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])}," Squad Management ",2),e("button",{onClick:t[2]||(t[2]=o=>r.activeTab="compliance"),class:p(["py-4 px-1 border-b-2 font-medium text-sm",r.activeTab==="compliance"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])}," Compliance Rules ",2),e("button",{onClick:t[3]||(t[3]=o=>r.activeTab="audit"),class:p(["py-4 px-1 border-b-2 font-medium text-sm",r.activeTab==="audit"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])}," Audit Trail ",2)])])]),r.activeTab==="users"?(a(),i("div",D,[e("div",P,[e("div",I,[t[16]||(t[16]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900"},"Users"),e("p",{class:"mt-1 text-sm text-gray-600"},"Manage team members and their roles")],-1)),e("button",{onClick:t[4]||(t[4]=o=>r.showCreateUserModal=!0),class:"flex items-center gap-2 px-4 py-2 font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700"},[...t[15]||(t[15]=[e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z","clip-rule":"evenodd"})],-1),g(" Add User ",-1)])])]),e("div",Y,[e("div",H,[u(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>r.userSearch=o),type:"text",placeholder:"Search users...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[b,r.userSearch]])]),u(e("select",{"onUpdate:modelValue":t[6]||(t[6]=o=>r.userRoleFilter=o),class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[...t[17]||(t[17]=[w('<option value="">All Roles</option><option value="admin">Admin</option><option value="squad_lead">Squad Lead</option><option value="member">Member</option><option value="viewer">Viewer</option>',5)])],512),[[v,r.userRoleFilter]])])]),e("div",J,[r.loading?(a(),i("div",O,[...t[18]||(t[18]=[e("div",{class:"inline-block w-8 h-8 border-4 border-blue-500 rounded-full animate-spin border-t-transparent"},null,-1)])])):n.filteredUsers.length===0?(a(),i("div",G,[...t[19]||(t[19]=[e("svg",{class:"w-12 h-12 mx-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1),e("p",{class:"mt-2"},"No users found",-1)])])):(a(),i("table",K,[t[20]||(t[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-xs font-medium text-left text-gray-500 uppercase"},"Name"),e("th",{class:"px-6 py-3 text-xs font-medium text-left text-gray-500 uppercase"},"Email"),e("th",{class:"px-6 py-3 text-xs font-medium text-left text-gray-500 uppercase"},"Role"),e("th",{class:"px-6 py-3 text-xs font-medium text-left text-gray-500 uppercase"},"Squads"),e("th",{class:"px-6 py-3 text-xs font-medium text-left text-gray-500 uppercase"},"Status"),e("th",{class:"px-6 py-3 text-xs font-medium text-left text-gray-500 uppercase"},"Actions")])],-1)),e("tbody",Q,[(a(!0),i(_,null,U(n.filteredUsers,o=>(a(),i("tr",{key:o.id,class:"hover:bg-gray-50"},[e("td",W,[e("div",X,[e("div",Z,[e("span",$,l(n.getInitials(o.name)),1)]),e("div",ee,[e("div",te,l(o.name),1)])])]),e("td",se,l(o.email),1),e("td",re,[e("span",{class:p([n.getRoleBadgeClass(o.role),"px-2 py-1 text-xs rounded-full"])},l(n.getRoleLabel(o.role)),3)]),e("td",oe,l(o.squads_count||0)+" squad(s) ",1),e("td",ie,[e("span",{class:p([o.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800","px-2 py-1 text-xs rounded-full"])},l(o.is_active?"Active":"Inactive"),3)]),e("td",ae,[e("button",{onClick:T=>n.editUser(o),class:"text-blue-600 hover:text-blue-900"}," Edit ",8,le),e("button",{onClick:T=>n.toggleUserStatus(o),class:p(o.is_active?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900")},l(o.is_active?"Deactivate":"Activate"),11,ne)])]))),128))])]))])])):m("",!0),r.activeTab==="squads"?(a(),i("div",de,[e("div",ue,[e("p",me,[t[22]||(t[22]=g("Squad management available in ",-1)),y(f,{to:"/squads",class:"text-blue-600 hover:underline"},{default:k(()=>[...t[21]||(t[21]=[g("Squads page",-1)])]),_:1})])])])):m("",!0),r.activeTab==="compliance"?(a(),i("div",pe,[e("div",ce,[e("p",ge,[t[24]||(t[24]=g("Compliance rules available in ",-1)),y(f,{to:"/settings",class:"text-blue-600 hover:underline"},{default:k(()=>[...t[23]||(t[23]=[g("Settings page",-1)])]),_:1})])])])):m("",!0),r.activeTab==="audit"?(a(),i("div",be,[e("div",xe,[t[26]||(t[26]=e("h3",{class:"mb-4 text-lg font-semibold text-gray-900"},"Recent Activity",-1)),e("div",ye,[(a(!0),i(_,null,U(r.auditLogs,o=>(a(),i("div",{key:o.id,class:"flex items-start gap-4 p-4 rounded-lg bg-gray-50"},[t[25]||(t[25]=e("div",{class:"flex items-center justify-center flex-shrink-0 w-10 h-10 bg-blue-100 rounded-full"},[e("svg",{class:"w-5 h-5 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z","clip-rule":"evenodd"})])],-1)),e("div",ve,[e("p",fe,l(o.action),1),e("p",he,l(o.user_name)+" • "+l(n.formatTime(o.created_at)),1)])]))),128))])])])):m("",!0)]),r.showCreateUserModal||r.editingUser?(a(),i("div",we,[e("div",_e,[e("h3",Ue,l(r.editingUser?"Edit User":"Create New User"),1),e("form",{onSubmit:t[14]||(t[14]=A((...o)=>n.saveUser&&n.saveUser(...o),["prevent"])),class:"space-y-4"},[e("div",ke,[e("div",null,[t[28]||(t[28]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Full Name *",-1)),u(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>r.userForm.name=o),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"John Doe"},null,512),[[b,r.userForm.name]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Email *",-1)),u(e("input",{"onUpdate:modelValue":t[8]||(t[8]=o=>r.userForm.email=o),type:"email",required:"",disabled:!!r.editingUser,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",placeholder:"john@example.com"},null,8,Ce),[[b,r.userForm.email]])])]),r.editingUser?m("",!0):(a(),i("div",Se,[e("div",null,[t[30]||(t[30]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Password *",-1)),u(e("input",{"onUpdate:modelValue":t[9]||(t[9]=o=>r.userForm.password=o),type:"password",required:!r.editingUser,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"••••••••"},null,8,Te),[[b,r.userForm.password]])]),e("div",null,[t[31]||(t[31]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Confirm Password *",-1)),u(e("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>r.userForm.password_confirmation=o),type:"password",required:!r.editingUser,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"••••••••"},null,8,qe),[[b,r.userForm.password_confirmation]])])])),e("div",null,[t[33]||(t[33]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Role *",-1)),u(e("select",{"onUpdate:modelValue":t[11]||(t[11]=o=>r.userForm.role=o),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[...t[32]||(t[32]=[e("option",{value:"member"},"Member",-1),e("option",{value:"squad_lead"},"Squad Lead",-1),e("option",{value:"admin"},"Admin",-1),e("option",{value:"viewer"},"Viewer",-1)])],512),[[v,r.userForm.role]]),t[34]||(t[34]=e("p",{class:"mt-1 text-xs text-gray-500"},"Select the user's role and permissions",-1))]),e("div",null,[t[36]||(t[36]=e("label",{class:"block mb-1 text-sm font-medium text-gray-700"},"Timezone",-1)),u(e("select",{"onUpdate:modelValue":t[12]||(t[12]=o=>r.userForm.timezone=o),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[...t[35]||(t[35]=[w('<option value="America/New_York">Eastern Time (ET)</option><option value="America/Chicago">Central Time (CT)</option><option value="America/Los_Angeles">Pacific Time (PT)</option><option value="Europe/London">London (GMT)</option><option value="Asia/Tokyo">Tokyo (JST)</option>',5)])],512),[[v,r.userForm.timezone]])]),r.formError?(a(),i("div",Ae,[e("p",Fe,l(r.formError),1)])):m("",!0),e("div",Me,[e("button",{type:"button",onClick:t[13]||(t[13]=(...o)=>n.closeUserModal&&n.closeUserModal(...o)),class:"flex-1 px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50"}," Cancel "),e("button",{type:"submit",disabled:r.saving,class:"flex-1 px-4 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50"},l(r.saving?"Saving...":r.editingUser?"Update User":"Create User"),9,Le)])],32)])])):m("",!0)])}const Ee=q(V,[["render",Ne]]);export{Ee as default};
