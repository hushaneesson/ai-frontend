import{_ as P,c as u,a as s,h as c,i as b,r as k,t as l,w as v,b as w,e as d,v as p,k as E,d as F,g as i,u as h,p as m,o as g}from"./index-Cx3iL0RU.js";const T={name:"Profile",data(){return{profileForm:{name:"",email:"",timezone:"America/New_York"},passwordForm:{current_password:"",new_password:"",new_password_confirmation:""},stats:{totalDays:0,totalHours:0,squadsCount:0,leaveRequests:0},updating:!1,updateError:null,updateSuccess:!1,changingPassword:!1,passwordError:null,passwordSuccess:!1}},computed:{user(){return h().user}},mounted(){this.loadProfile(),this.loadStats()},methods:{loadProfile(){this.user&&(this.profileForm={name:this.user.name||"",email:this.user.email||"",timezone:this.user.timezone||"America/New_York"})},async loadStats(){try{const o=await m.attendance.getAll(),e=o.data.data||o.data||[];this.stats.totalDays=e.length;const y=e.reduce((r,f)=>{if(f.check_out_time){const _=new Date(f.check_in_time),S=(new Date(f.check_out_time)-_)/1e3/60;return r+S}return r},0);this.stats.totalHours=Math.round(y/60);const x=await m.squads.getAll(),t=x.data.data||x.data||[];this.stats.squadsCount=t.length;const a=await m.leave.getMyRequests(),n=a.data.data||a.data||[];this.stats.leaveRequests=n.length}catch(o){console.error("Error loading stats:",o)}},async updateProfile(){this.updateError=null,this.updateSuccess=!1,this.updating=!0;try{(await m.auth.updateProfile(this.profileForm)).data.success&&(await h().fetchUser(),this.updateSuccess=!0,setTimeout(()=>this.updateSuccess=!1,3e3))}catch(o){this.updateError=o.response?.data?.message||"Failed to update profile"}finally{this.updating=!1}},async changePassword(){if(this.passwordError=null,this.passwordSuccess=!1,this.passwordForm.new_password.length<8){this.passwordError="New password must be at least 8 characters";return}if(this.passwordForm.new_password!==this.passwordForm.new_password_confirmation){this.passwordError="Passwords do not match";return}this.changingPassword=!0;try{(await m.auth.changePassword(this.passwordForm)).data.success&&(this.passwordSuccess=!0,this.passwordForm={current_password:"",new_password:"",new_password_confirmation:""},setTimeout(()=>this.passwordSuccess=!1,3e3))}catch(o){this.passwordError=o.response?.data?.message||"Failed to change password"}finally{this.changingPassword=!1}},getInitials(o){return o?.split(" ").map(e=>e[0]).join("").toUpperCase()||"??"},getRoleLabel(o){return{admin:"ðŸ‘‘ Administrator",squad_lead:"â­ Squad Lead",member:"ðŸ‘¤ Member",viewer:"ðŸ‘ï¸ Viewer"}[o]||o},formatDate(o){return o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"},handleLogout(){h().logout(),this.$router.push("/login")}}},A={class:"min-h-screen bg-gray-50"},C={class:"bg-white shadow-sm border-b border-gray-200"},D={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},q={class:"flex justify-between h-16"},L={class:"flex items-center"},N={class:"flex items-center space-x-4"},M={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},V={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mb-6"},U={class:"bg-gradient-to-r from-blue-500 to-indigo-600 px-6 py-8"},R={class:"flex items-center gap-6"},z={class:"w-24 h-24 rounded-full bg-white flex items-center justify-center"},H={class:"text-4xl font-bold text-blue-600"},I={class:"text-white"},Y={class:"text-2xl font-bold"},j={class:"text-blue-100"},B={class:"inline-block mt-2 px-3 py-1 bg-white bg-opacity-20 rounded-full text-sm"},G={class:"p-6"},O={key:0,class:"p-4 bg-red-50 border-l-4 border-red-500 text-red-700 rounded"},J={class:"text-sm"},K={key:1,class:"p-4 bg-green-50 border-l-4 border-green-500 text-green-700 rounded"},Q=["disabled"],W={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6"},X={key:0,class:"p-4 bg-red-50 border-l-4 border-red-500 text-red-700 rounded"},Z={class:"text-sm"},$={key:1,class:"p-4 bg-green-50 border-l-4 border-green-500 text-green-700 rounded"},ee=["disabled"],se={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},te={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},oe={class:"text-center p-4 bg-blue-50 rounded-lg"},re={class:"text-2xl font-bold text-blue-600"},ae={class:"text-center p-4 bg-green-50 rounded-lg"},le={class:"text-2xl font-bold text-green-600"},ne={class:"text-center p-4 bg-purple-50 rounded-lg"},de={class:"text-2xl font-bold text-purple-600"},ie={class:"text-center p-4 bg-yellow-50 rounded-lg"},ue={class:"text-2xl font-bold text-yellow-600"},pe={class:"mt-6 pt-6 border-t"},me={class:"text-sm text-gray-600"},ge={class:"text-sm text-gray-600 mt-2"};function ce(o,e,y,x,t,a){const n=k("router-link");return g(),u("div",A,[s("nav",C,[s("div",D,[s("div",q,[s("div",L,[c(n,{to:"/dashboard",class:"text-2xl font-bold text-gray-900"},{default:b(()=>[...e[9]||(e[9]=[i("Agile Squad",-1)])]),_:1})]),s("div",N,[c(n,{to:"/dashboard",class:"text-gray-600 hover:text-gray-900"},{default:b(()=>[...e[10]||(e[10]=[i("Dashboard",-1)])]),_:1}),c(n,{to:"/squads",class:"text-gray-600 hover:text-gray-900"},{default:b(()=>[...e[11]||(e[11]=[i("Squads",-1)])]),_:1}),c(n,{to:"/leave-requests",class:"text-gray-600 hover:text-gray-900"},{default:b(()=>[...e[12]||(e[12]=[i("Leave",-1)])]),_:1}),s("button",{onClick:e[0]||(e[0]=(...r)=>a.handleLogout&&a.handleLogout(...r)),class:"text-gray-600 hover:text-gray-900"},"Logout")])])])]),s("div",M,[e[32]||(e[32]=s("div",{class:"mb-8"},[s("h2",{class:"text-3xl font-bold text-gray-900"},"Profile Settings"),s("p",{class:"text-gray-600 mt-1"},"Manage your account information and preferences")],-1)),s("div",V,[s("div",U,[s("div",R,[s("div",z,[s("span",H,l(a.getInitials(a.user?.name)),1)]),s("div",I,[s("h3",Y,l(a.user?.name),1),s("p",j,l(a.user?.email),1),s("span",B,l(a.getRoleLabel(a.user?.role)),1)])])]),s("div",G,[e[19]||(e[19]=s("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Account Information",-1)),s("form",{onSubmit:e[4]||(e[4]=v((...r)=>a.updateProfile&&a.updateProfile(...r),["prevent"])),class:"space-y-4"},[s("div",null,[e[13]||(e[13]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Full Name",-1)),d(s("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>t.profileForm.name=r),type:"text",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Your full name"},null,512),[[p,t.profileForm.name]])]),s("div",null,[e[14]||(e[14]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Email Address",-1)),d(s("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>t.profileForm.email=r),type:"email",disabled:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500 cursor-not-allowed"},null,512),[[p,t.profileForm.email]]),e[15]||(e[15]=s("p",{class:"text-xs text-gray-500 mt-1"},"Email cannot be changed",-1))]),s("div",null,[e[17]||(e[17]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Timezone",-1)),d(s("select",{"onUpdate:modelValue":e[3]||(e[3]=r=>t.profileForm.timezone=r),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[...e[16]||(e[16]=[F('<option value="America/New_York">Eastern Time (ET)</option><option value="America/Chicago">Central Time (CT)</option><option value="America/Denver">Mountain Time (MT)</option><option value="America/Los_Angeles">Pacific Time (PT)</option><option value="America/Phoenix">Arizona Time</option><option value="Europe/London">London (GMT)</option><option value="Europe/Paris">Paris (CET)</option><option value="Asia/Tokyo">Tokyo (JST)</option><option value="Asia/Shanghai">Shanghai (CST)</option><option value="Asia/Dubai">Dubai (GST)</option><option value="Australia/Sydney">Sydney (AEDT)</option>',11)])],512),[[E,t.profileForm.timezone]])]),t.updateError?(g(),u("div",O,[s("p",J,l(t.updateError),1)])):w("",!0),t.updateSuccess?(g(),u("div",K,[...e[18]||(e[18]=[s("p",{class:"text-sm"},"Profile updated successfully!",-1)])])):w("",!0),s("button",{type:"submit",disabled:t.updating,class:"w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition disabled:opacity-50"},l(t.updating?"Updating...":"Update Profile"),9,Q)],32)])]),s("div",W,[e[24]||(e[24]=s("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Change Password",-1)),s("form",{onSubmit:e[8]||(e[8]=v((...r)=>a.changePassword&&a.changePassword(...r),["prevent"])),class:"space-y-4"},[s("div",null,[e[20]||(e[20]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Current Password",-1)),d(s("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>t.passwordForm.current_password=r),type:"password",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter current password"},null,512),[[p,t.passwordForm.current_password]])]),s("div",null,[e[21]||(e[21]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"New Password",-1)),d(s("input",{"onUpdate:modelValue":e[6]||(e[6]=r=>t.passwordForm.new_password=r),type:"password",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter new password (min. 8 characters)"},null,512),[[p,t.passwordForm.new_password]])]),s("div",null,[e[22]||(e[22]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Confirm New Password",-1)),d(s("input",{"onUpdate:modelValue":e[7]||(e[7]=r=>t.passwordForm.new_password_confirmation=r),type:"password",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Confirm new password"},null,512),[[p,t.passwordForm.new_password_confirmation]])]),t.passwordError?(g(),u("div",X,[s("p",Z,l(t.passwordError),1)])):w("",!0),t.passwordSuccess?(g(),u("div",$,[...e[23]||(e[23]=[s("p",{class:"text-sm"},"Password changed successfully!",-1)])])):w("",!0),s("button",{type:"submit",disabled:t.changingPassword,class:"w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition disabled:opacity-50"},l(t.changingPassword?"Changing...":"Change Password"),9,ee)],32)]),s("div",se,[e[31]||(e[31]=s("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Account Statistics",-1)),s("div",te,[s("div",oe,[s("p",re,l(t.stats.totalDays||0),1),e[25]||(e[25]=s("p",{class:"text-xs text-gray-600 mt-1"},"Days Tracked",-1))]),s("div",ae,[s("p",le,l(t.stats.totalHours||0),1),e[26]||(e[26]=s("p",{class:"text-xs text-gray-600 mt-1"},"Total Hours",-1))]),s("div",ne,[s("p",de,l(t.stats.squadsCount||0),1),e[27]||(e[27]=s("p",{class:"text-xs text-gray-600 mt-1"},"Squads",-1))]),s("div",ie,[s("p",ue,l(t.stats.leaveRequests||0),1),e[28]||(e[28]=s("p",{class:"text-xs text-gray-600 mt-1"},"Leave Requests",-1))])]),s("div",pe,[s("p",me,[e[29]||(e[29]=s("strong",null,"Member since:",-1)),i(" "+l(a.formatDate(a.user?.created_at)),1)]),s("p",ge,[e[30]||(e[30]=s("strong",null,"Last login:",-1)),i(" "+l(a.formatDate(a.user?.last_login_at||new Date)),1)])])])])])}const xe=P(T,[["render",ce]]);export{xe as default};
