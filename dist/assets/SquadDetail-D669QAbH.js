import{_ as k,c as a,h as v,a as e,b as u,r as f,i as S,t as l,n as p,F as c,j as b,w as q,e as x,k as h,v as D,u as _,q as C,o as d}from"./index-urv8ZhUX.js";import{N as A}from"./NavBar-DUvPfABS.js";const n=C.create({baseURL:"https://speedlab-agile-a0ayh9gvbaaxdddt.eastus2-01.azurewebsites.net/api"});n.interceptors.request.use(s=>{const t=localStorage.getItem("token");return t&&(s.headers.Authorization=`Bearer ${t}`),s});const B={name:"SquadDetail",components:{NavBar:A},data(){return{squad:null,members:[],activeSprint:null,presenceBoard:[],loading:!1,showAddMemberModal:!1,availableUsers:[],addMemberForm:{user_id:"",role:"member",joined_at:new Date().toISOString().split("T")[0]},addMemberError:null,addingMember:!1}},computed:{user(){return _().user},canManage(){return this.user?.role==="admin"||this.isSquadLead},isSquadLead(){return this.members.some(s=>s.id===this.user?.id&&s.pivot?.role==="lead")}},async mounted(){await this.loadSquadDetails(),await this.loadAvailableUsers()},methods:{async loadAvailableUsers(){try{const s=await n.get("/users");this.availableUsers=s.data.data||s.data||[]}catch(s){console.error("Error loading users:",s)}},async addMember(){this.addMemberError=null,this.addingMember=!0;try{await n.post(`/squads/${this.squad.id}/members`,this.addMemberForm),await this.loadSquadDetails(),this.closeAddMemberModal()}catch(s){this.addMemberError=s.response?.data?.message||"Failed to add member"}finally{this.addingMember=!1}},closeAddMemberModal(){this.showAddMemberModal=!1,this.addMemberForm={user_id:"",role:"member",joined_at:new Date().toISOString().split("T")[0]},this.addMemberError=null},async loadSquadDetails(){this.loading=!0;try{const s=this.$route.params.id,t=await n.get(`/squads/${s}`);this.squad=t.data.data||t.data;const m=await n.get(`/squads/${s}/members`);this.members=m.data.data||m.data||[];try{const i=await n.get(`/squads/${s}/active-sprint`);this.activeSprint=i.data.data||i.data}catch{console.log("No active sprint")}const r=(await n.get(`/attendance/squad/${s}/today`)).data.data;this.presenceBoard=r.presence_board||[]}catch(s){console.error("Error loading squad details:",s),alert("Failed to load squad details")}finally{this.loading=!1}},async removeMember(s){if(confirm("Are you sure you want to remove this member?"))try{await n.delete(`/squads/${this.squad.id}/members/${s}`),await this.loadSquadDetails()}catch{alert("Failed to remove member")}},getInitials(s){return s?.split(" ").map(t=>t[0]).join("").toUpperCase()||"??"},getRoleBadgeClass(s){return{lead:"bg-yellow-100 text-yellow-800",member:"bg-blue-100 text-blue-800",viewer:"bg-gray-100 text-gray-800"}[s]||"bg-gray-100 text-gray-800"},getWorkModeLabel(s){return{office:"🏢 Office",remote:"🏠 Remote",client_site:"👥 Client",ooo:"🚫 OOO"}[s]||s},getWorkModeClass(s){return{office:"bg-blue-100 text-blue-800",remote:"bg-purple-100 text-purple-800",client_site:"bg-green-100 text-green-800",ooo:"bg-gray-100 text-gray-800"}[s]||"bg-gray-100 text-gray-800"},formatDate(s){return new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},formatTime(s){return new Date(s).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})},getDaysRemaining(s){const t=new Date(s),g=Math.ceil((t-new Date)/(1e3*60*60*24));return g>0?`${g} days`:"Ended"},handleLogout(){_().logout(),this.$router.push("/login")}}},j={class:"min-h-screen bg-gray-50"},z={class:"px-4 py-8 mx-auto max-w-7xl sm:px-6 lg:px-8"},L={key:0,class:"py-12 text-center"},F={key:1},R={class:"mb-8"},U={class:"flex items-center gap-3 mb-2"},E={class:"text-3xl font-bold text-gray-900"},N={class:"text-gray-600"},T={class:"grid grid-cols-1 gap-6 mb-8 md:grid-cols-3"},V={class:"p-6 bg-white border border-gray-200 rounded-lg shadow-sm"},I={class:"flex items-center justify-between"},O={class:"text-3xl font-bold text-blue-600"},H={class:"p-6 bg-white border border-gray-200 rounded-lg shadow-sm"},W={class:"flex items-center justify-between"},G={class:"text-3xl font-bold text-green-600"},J={class:"p-6 bg-white border border-gray-200 rounded-lg shadow-sm"},P={class:"flex items-center justify-between"},K={class:"text-lg font-bold text-purple-600"},Q={key:0,class:"p-6 mb-8 bg-white border border-gray-200 rounded-lg shadow-sm"},X={class:"p-6 rounded-lg bg-gradient-to-r from-blue-50 to-indigo-50"},Y={class:"mb-2 text-lg font-bold text-gray-900"},Z={class:"mb-4 text-gray-600"},$={class:"grid grid-cols-2 gap-4 mb-4 md:grid-cols-4"},ee={class:"font-medium text-gray-900"},te={class:"font-medium text-gray-900"},se={class:"font-medium text-blue-600"},re={class:"px-2 py-1 text-xs font-medium text-green-800 bg-green-100 rounded-full"},oe={key:0,class:"mt-4"},le={class:"space-y-1 list-disc list-inside"},ae={class:"p-6 mb-8 bg-white border border-gray-200 rounded-lg shadow-sm"},de={class:"flex items-center justify-between mb-6"},ie={key:0,class:"py-8 text-center text-gray-500"},ne={key:1,class:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"},ue={class:"flex items-center gap-3"},me={class:"flex items-center justify-center w-12 h-12 bg-blue-100 rounded-full"},ge={class:"font-semibold text-blue-600"},ce={class:"flex-1"},be={class:"font-semibold text-gray-900"},pe={class:"text-sm text-gray-600"},xe=["onClick"],ye={class:"p-6 bg-white border border-gray-200 rounded-lg shadow-sm"},ve={key:0,class:"py-8 text-center text-gray-500"},fe={key:1,class:"space-y-3"},he={class:"flex items-center gap-3"},_e={class:"font-medium text-gray-900"},we={class:"text-sm text-gray-600"},Me={class:"flex items-center gap-3"},ke={key:0,class:"text-sm font-medium text-green-600"},Se={key:1,class:"text-sm text-gray-500"},qe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50"},De={class:"w-full max-w-md p-6 bg-white rounded-xl"},Ce=["value"],Ae={key:0,class:"p-3 text-sm text-red-700 rounded-lg bg-red-50"},Be={class:"flex gap-3 pt-4"},je=["disabled"];function ze(s,t,m,g,r,i){const w=f("NavBar"),M=f("router-link");return d(),a("div",j,[v(w),e("div",z,[r.loading?(d(),a("div",L,[...t[6]||(t[6]=[e("div",{class:"inline-block w-12 h-12 border-4 border-blue-500 rounded-full animate-spin border-t-transparent"},null,-1),e("p",{class:"mt-4 text-gray-500"},"Loading squad details...",-1)])])):r.squad?(d(),a("div",F,[e("div",R,[e("div",U,[v(M,{to:"/squads",class:"text-gray-600 hover:text-gray-900"},{default:S(()=>[...t[7]||(t[7]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),_:1}),e("h2",E,l(r.squad.name),1),e("span",{class:p(["px-3 py-1 text-xs font-medium rounded-full",r.squad.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"])},l(r.squad.is_active?"Active":"Inactive"),3)]),e("p",N,l(r.squad.description||"No description available"),1)]),e("div",T,[e("div",V,[e("div",I,[e("div",null,[t[8]||(t[8]=e("p",{class:"text-sm text-gray-600"},"Members",-1)),e("p",O,l(r.members.length),1)]),t[9]||(t[9]=e("div",{class:"flex items-center justify-center w-12 h-12 bg-blue-100 rounded-full"},[e("svg",{class:"w-6 h-6 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"})])],-1))])]),e("div",H,[e("div",W,[e("div",null,[t[10]||(t[10]=e("p",{class:"text-sm text-gray-600"},"Sprint Duration",-1)),e("p",G,l(r.squad.sprint_duration_days)+"d ",1)]),t[11]||(t[11]=e("div",{class:"flex items-center justify-center w-12 h-12 bg-green-100 rounded-full"},[e("svg",{class:"w-6 h-6 text-green-600",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z","clip-rule":"evenodd"})])],-1))])]),e("div",J,[e("div",P,[e("div",null,[t[12]||(t[12]=e("p",{class:"text-sm text-gray-600"},"Timezone",-1)),e("p",K,l(r.squad.timezone),1)]),t[13]||(t[13]=e("div",{class:"flex items-center justify-center w-12 h-12 bg-purple-100 rounded-full"},[e("svg",{class:"w-6 h-6 text-purple-600",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z","clip-rule":"evenodd"})])],-1))])])]),r.activeSprint?(d(),a("div",Q,[t[19]||(t[19]=e("h3",{class:"mb-4 text-xl font-semibold text-gray-900"}," Active Sprint ",-1)),e("div",X,[e("h4",Y,l(r.activeSprint.name),1),e("p",Z,l(r.activeSprint.description),1),e("div",$,[e("div",null,[t[14]||(t[14]=e("p",{class:"text-xs text-gray-500"},"Start Date",-1)),e("p",ee,l(i.formatDate(r.activeSprint.start_date)),1)]),e("div",null,[t[15]||(t[15]=e("p",{class:"text-xs text-gray-500"},"End Date",-1)),e("p",te,l(i.formatDate(r.activeSprint.end_date)),1)]),e("div",null,[t[16]||(t[16]=e("p",{class:"text-xs text-gray-500"},"Days Remaining",-1)),e("p",se,l(i.getDaysRemaining(r.activeSprint.end_date)),1)]),e("div",null,[t[17]||(t[17]=e("p",{class:"text-xs text-gray-500"},"Status",-1)),e("span",re,l(r.activeSprint.status),1)])]),r.activeSprint.goals&&r.activeSprint.goals.length?(d(),a("div",oe,[t[18]||(t[18]=e("p",{class:"mb-2 text-sm font-medium text-gray-700"}," Sprint Goals: ",-1)),e("ul",le,[(d(!0),a(c,null,b(r.activeSprint.goals,(o,y)=>(d(),a("li",{key:y,class:"text-sm text-gray-600"},l(o),1))),128))])])):u("",!0)])])):u("",!0),e("div",ae,[e("div",de,[t[20]||(t[20]=e("h3",{class:"text-xl font-semibold text-gray-900"},"Team Members",-1)),i.canManage?(d(),a("button",{key:0,onClick:t[0]||(t[0]=o=>r.showAddMemberModal=!0),class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700"}," Add Member ")):u("",!0)]),r.members.length===0?(d(),a("div",ie,[...t[21]||(t[21]=[e("p",null,"No members in this squad yet",-1)])])):(d(),a("div",ne,[(d(!0),a(c,null,b(r.members,o=>(d(),a("div",{key:o.id,class:"p-4 transition border border-gray-200 rounded-lg hover:shadow-md"},[e("div",ue,[e("div",me,[e("span",ge,l(i.getInitials(o.name)),1)]),e("div",ce,[e("h4",be,l(o.name),1),e("p",pe,l(o.email),1),e("span",{class:p(["inline-block mt-1 px-2 py-0.5 text-xs rounded-full",i.getRoleBadgeClass(o.pivot?.role)])},l(o.pivot?.role||"member"),3)]),i.canManage&&o.pivot?.role!=="lead"?(d(),a("button",{key:0,onClick:y=>i.removeMember(o.id),class:"text-red-600 hover:text-red-700",title:"Remove"},[...t[22]||(t[22]=[e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])],8,xe)):u("",!0)])]))),128))]))]),e("div",ye,[t[25]||(t[25]=e("h3",{class:"mb-6 text-xl font-semibold text-gray-900"}," Today's Presence ",-1)),r.presenceBoard.length===0?(d(),a("div",ve,[...t[23]||(t[23]=[e("p",null,"No attendance records for today",-1)])])):(d(),a("div",fe,[(d(!0),a(c,null,b(r.presenceBoard,o=>(d(),a("div",{key:o.id,class:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50"},[e("div",he,[t[24]||(t[24]=e("div",{class:"flex items-center justify-center w-10 h-10 bg-green-100 rounded-full"},[e("svg",{class:"w-5 h-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1)),e("div",null,[e("p",_e,l(o.user?.name),1),e("p",we," Checked in at "+l(i.formatTime(o.check_in_time)),1)])]),e("div",Me,[e("span",{class:p(["px-3 py-1 text-xs font-medium rounded-full",i.getWorkModeClass(o.work_mode)])},l(i.getWorkModeLabel(o.work_mode)),3),o.check_out_time?(d(),a("span",Se," Out at "+l(i.formatTime(o.check_out_time)),1)):(d(),a("span",ke," Active "))])]))),128))]))])])):u("",!0)]),r.showAddMemberModal?(d(),a("div",qe,[e("div",De,[t[31]||(t[31]=e("h3",{class:"mb-4 text-xl font-bold text-gray-900"},"Add Team Member",-1)),e("form",{onSubmit:t[5]||(t[5]=q((...o)=>i.addMember&&i.addMember(...o),["prevent"])),class:"space-y-4"},[e("div",null,[t[27]||(t[27]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"Select User",-1)),x(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>r.addMemberForm.user_id=o),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[t[26]||(t[26]=e("option",{value:""},"Choose a user...",-1)),(d(!0),a(c,null,b(r.availableUsers,o=>(d(),a("option",{key:o.id,value:o.id},l(o.name)+" ("+l(o.email)+") ",9,Ce))),128))],512),[[h,r.addMemberForm.user_id]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"Role",-1)),x(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>r.addMemberForm.role=o),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[...t[28]||(t[28]=[e("option",{value:"member"},"Member",-1),e("option",{value:"lead"},"Squad Lead",-1)])],512),[[h,r.addMemberForm.role]])]),e("div",null,[t[30]||(t[30]=e("label",{class:"block mb-2 text-sm font-medium text-gray-700"},"Joined Date",-1)),x(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>r.addMemberForm.joined_at=o),type:"date",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[D,r.addMemberForm.joined_at]])]),r.addMemberError?(d(),a("div",Ae,l(r.addMemberError),1)):u("",!0),e("div",Be,[e("button",{type:"button",onClick:t[4]||(t[4]=(...o)=>i.closeAddMemberModal&&i.closeAddMemberModal(...o)),class:"flex-1 px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50"}," Cancel "),e("button",{type:"submit",disabled:r.addingMember,class:"flex-1 px-4 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50"},l(r.addingMember?"Adding...":"Add Member"),9,je)])],32)])])):u("",!0)])}const Re=k(B,[["render",ze]]);export{Re as default};
